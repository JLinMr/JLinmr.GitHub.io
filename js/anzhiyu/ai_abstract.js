!function(){const{randomNum:e,basicWordCount:t,btnLink:n,key:i,Referer:a,gptName:o,switchBtn:l,mode:r}=GLOBAL_CONFIG.postHeadAiDescription,{title:c,postAI:s,pageFillDescription:d}=GLOBAL_CONFIG_SITE;let y,m=-1,u=!0,f=r,h=0,p=null,g=!1,T=null;const b=document.querySelector(".post-ai-description"),v=b.querySelector(".ai-title .anzhiyufont.anzhiyu-icon-arrow-rotate-right");let E=b.querySelector(".anzhiyu-icon-circle-dot");const k=b.querySelector(".ai-explanation");let L="",I="",M=600,A=0,S=0,q=[],w=0;const G=new IntersectionObserver((e=>{let t=e[0].isIntersecting;u=t,u&&(M=0===A?200:20,q[1]=setTimeout((()=>{S&&(A=0,S=0),0===A&&(k.innerHTML=L.charAt(0)),requestAnimationFrame(P)}),M))}),{threshold:0}),x=[function(){j("tianli"==f?"我是文章辅助AI: TianliGPT，点击下方的按钮，让我生成本文简介、推荐相关文章等。":`我是文章辅助AI: ${o} GPT，点击下方的按钮，让我生成本文简介、推荐相关文章等。`)},function(){v.click()},function(){A=0,S=1,$(),u=!1,w=0,k.innerHTML="生成中. . .",L="",I="",G.disconnect(),q[2]=setTimeout((()=>{k.innerHTML=function(){let e=document.querySelectorAll(".relatedPosts-list a");if(!e.length){const t=document.querySelector(".card-widget.card-recent-post");if(!t)return"";e=t.querySelectorAll(".aside-list-item a");let n="";for(let t=0;t<e.length;t++){const i=e[t];n+=`<div class="ai-recommend-item"><span class="index">${t+1}：</span><a href="javascript:;" onclick="pjax.loadUrl('${i.href}')" title="${i.title}" data-pjax-state="">${i.title}</a></div>`}return`很抱歉，无法找到类似的文章，你也可以看看本站最新发布的文章：<br /><div class="ai-recommend">${n}</div>`}let t="";for(let n=0;n<e.length;n++){const i=e[n];t+=`<div class="ai-recommend-item"><span>推荐${n+1}：</span><a href="javascript:;" onclick="pjax.loadUrl('${i.href}')" title="${i.title}" data-pjax-state="">${i.title}</a></div>`}return`推荐文章：<br /><div class="ai-recommend">${t}</div>`}()}),600)},function(){j("正在前往博客主页...",!1),q[2]=setTimeout((()=>{window.pjax?pjax.loadUrl("/"):location.href=location.origin}),1e3)}],B=b.querySelectorAll(".ai-btn-item");function P(e){if(u)if(P.start||(P.start=e),w=e-P.start,w>=20){if(P.start=e,A<I-1){let e=L.charAt(A+1),t=/[,.，。!?！？]/.test(e)?150:20;k.firstElementChild&&k.removeChild(k.firstElementChild),k.innerHTML+=e;let n=document.createElement("div");n.className="ai-cursor",k.appendChild(n),A++,150===t&&(b.querySelector(".ai-explanation .ai-cursor").style.opacity="0.2"),A===I-1&&(G.disconnect(),k.removeChild(k.firstElementChild)),q[0]=setTimeout((()=>{requestAnimationFrame(P)}),t)}}else requestAnimationFrame(P)}function $(){q.length&&q.forEach((e=>{e&&clearTimeout(e)}))}function j(e,t=!0){A=0,S=1,$(),u=!1,w=0,G.disconnect(),k.innerHTML=t?"生成中. . .":"请等待. . .",L=e,I=L.length,G.observe(b)}async function C(e=t){"tianli"===f?await async function(e){A=0,S=1,$(),u=!1,w=0,G.disconnect(),e=Math.max(10,Math.min(2e3,e));const t={key:i,Referer:a},n=(c+d).trim().substring(0,e),o={key:t.key,content:n,url:location.href},l={method:"POST",headers:{"Content-Type":"application/json",Referer:t.Referer},body:JSON.stringify(o)};console.info(n.length);try{let e,t=null;t&&clearInterval(t),t=setInterval((()=>{const e="生成中"+".".repeat(S);k.innerHTML=e,S=S%3+1}),500);const n=await fetch("https://summary.tianli0.top/",l);let i;i=403===n.status?{summary:"403 refer与key不匹配。"}:500===n.status?{summary:"500 系统内部错误"}:await n.json(),e=i.summary.trim(),T=i.id,setTimeout((()=>{v.style.opacity="1"}),300),j(e||"摘要获取失败!!!请检查Tianli服务是否正常!!!"),clearInterval(t)}catch(e){console.error(e),k.innerHTML="发生异常"+e}}(e):function(){const e=s.split(",").map((e=>e.trim()));if(1!==e.length){let t=Math.floor(Math.random()*e.length);for(;t===m;)t=Math.floor(Math.random()*e.length);m=t,j(e[t])}else j(e[0]);setTimeout((()=>{v.style.opacity="1"}),600)}()}Array.from(B).filter((e=>"go-tianli-blog"!==e.id)).forEach(((e,t)=>{e.addEventListener("click",(()=>{x[t]()}))})),document.getElementById("ai-tag").addEventListener("click",(function(){"tianli"===f?(b.querySelectorAll(".ai-btn-item").forEach((e=>e.style.display="none")),document.getElementById("go-tianli-blog").style.display="block",j("你好，我是Tianli开发的摘要生成助理TianliGPT，是一个基于GPT-4的生成式AI。我在这里只负责摘要的预生成和显示，你无法与我直接沟通，如果你也需要一个这样的AI摘要接口，可以在下方购买。")):(b.querySelectorAll(".ai-btn-item").forEach((e=>e.style.display="block")),document.getElementById("go-tianli-blog").style.display="none",j(`你好，我是本站摘要生成助理${o} GPT，是一个基于GPT-4的生成式AI。我在这里只负责摘要的预生成和显示，你无法与我直接沟通。`))})),v.addEventListener("click",(function(){const n=(c+d).trim().substring(0,t);if(v.style.opacity="0.2",v.style.transitionDuration="0.3s",v.style.transform="rotate("+360*h+"deg)",n.length<=t){let t=n.length-Math.floor(Math.random()*e);for(;t===y||n.length-t===y;)t=n.length-Math.floor(Math.random()*e);y=t,C(t)}else{let i=Math.floor(Math.random()*e)+t;for(;i===y||n.length-i===y;)i=Math.floor(Math.random()*e)+t;C(i)}h++})),document.getElementById("go-tianli-blog").addEventListener("click",(()=>{window.open(n,"_blank")})),E.addEventListener("click",(async function(){if(!T)return void anzhiyu.snackbarShow("摘要还没加载完呢，请稍后。。。");if(E=b.querySelector(".anzhiyu-icon-circle-dot"),E.style.opacity="0.2",p&&!g)return p.pause(),g=!0,E.style.opacity="1",E.style.animation="",void(E.style.cssText="animation: ''; opacity: 1;cursor: pointer;");if(p&&g)return p.play(),g=!1,void(E.style.cssText="animation: breathe .5s linear infinite; opacity: 0.2;cursor: pointer");const e={key:i,Referer:a},t=new URLSearchParams({key:e.key,id:T}),n={method:"GET",headers:{"Content-Type":"application/json",Referer:e.Referer}};try{const e=await fetch(`https://summary.tianli0.top/audio?${t}`,n);if(403===e.status)console.error("403 refer与key不匹配。");else if(500===e.status)console.error("500 系统内部错误");else{const t=await e.blob(),n=URL.createObjectURL(t);p=new Audio(n),p.play(),E.style.cssText="animation: breathe .5s linear infinite; opacity: 0.2;cursor: pointer",p.addEventListener("ended",(()=>{p=null,E.style.opacity="1",E.style.animation=""}))}}catch(e){console.error("请求发生错误❎")}})),l&&document.getElementById("ai-Toggle").addEventListener("click",(function(){f="tianli"===f?"local":"tianli","tianli"===f?(document.getElementById("ai-tag").innerHTML="TianliGPT",E.style.opacity="1",E.style.cursor="pointer"):(E.style.opacity="0",E.style.cursor="auto",(document.getElementById("go-tianli-blog").style.display="block")&&(document.querySelectorAll(".ai-btn-item").forEach((e=>e.style.display="block")),document.getElementById("go-tianli-blog").style.display="none"),document.getElementById("ai-tag").innerHTML=o+" GPT");C()})),C(),document.getElementById("ai-tag").innerHTML="tianli"===f?"TianliGPT":o+" GPT"}();2[_0x1d1e62(0x1c3)])_0x109d72[_0x1d1e62(0x1c3)]=_0x2085d9;_0x29136f=_0x2085d9-_0x109d72[_0x1d1e62(0x1c3)];if(_0x29136f>=0x14){_0x109d72[_0x1d1e62(0x1c3)]=_0x2085d9;if(_0x1262e7<_0x137485-0x1){let _0x1048f4=_0x27febb['charAt'](_0x1262e7+0x1),_0x1ad22a=/[,.，。!?！？]/[_0x1d1e62(0x1c8)](_0x1048f4)?0x96:0x14;_0x25d92b[_0x1d1e62(0x1f7)]&&_0x25d92b['removeChild'](_0x25d92b[_0x1d1e62(0x1f7)]);_0x25d92b[_0x1d1e62(0x212)]+=_0x1048f4;let _0x13b8e4=document[_0x1d1e62(0x1f5)](_0x1d1e62(0x1e7));_0x13b8e4[_0x1d1e62(0x1e2)]=_0x1d1e62(0x1e9),_0x25d92b[_0x1d1e62(0x1d4)](_0x13b8e4),_0x1262e7++,_0x1ad22a===0x96&&(_0x305d78[_0x1d1e62(0x206)](_0x1d1e62(0x207))['style']['opacity']='0.2'),_0x1262e7===_0x137485-0x1&&(_0x35889e['disconnect'](),_0x25d92b[_0x1d1e62(0x1ba)](_0x25d92b[_0x1d1e62(0x1f7)])),_0x5b9ff5[0x0]=setTimeout(()=>{requestAnimationFrame(_0x109d72);},_0x1ad22a);}}else requestAnimationFrame(_0x109d72);}function _0x3e5e11(){const _0x440a79=_0x39996d;_0x5b9ff5[_0x440a79(0x1bf)]&&_0x5b9ff5['forEach'](_0x59ae65=>{_0x59ae65&&clearTimeout(_0x59ae65);});}function _0x42605c(_0x2be491,_0x21f257=!![]){const _0x121311=_0x39996d;_0x1262e7=0x0,_0x10d1f7=0x1,_0x3e5e11(),_0xdcbaea=![],_0x29136f=0x0,_0x35889e[_0x121311(0x1eb)](),_0x25d92b[_0x121311(0x212)]=_0x21f257?_0x121311(0x223):_0x121311(0x208),_0x27febb=_0x2be491,_0x137485=_0x27febb[_0x121311(0x1bf)],_0x35889e[_0x121311(0x20f)](_0x305d78);}async function _0x405b13(_0x2bbd56=_0x2561e4){const _0x59ac35=_0x39996d;_0x2a47fd===_0x59ac35(0x1b4)?await _0x141f34(_0x2bbd56):_0x23a76f();}async function _0x141f34(_0x3a5ab3){const _0x1a1cae=_0x39996d;_0x1262e7=0x0,_0x10d1f7=0x1,_0x3e5e11(),_0xdcbaea=![],_0x29136f=0x0,_0x35889e[_0x1a1cae(0x1eb)](),_0x3a5ab3=Math['max'](0xa,Math[_0x1a1cae(0x1ef)](0x7d0,_0x3a5ab3));const _0x76c547={'key':_0x57c502,'Referer':_0x48090c},_0x18781c=(_0x3f4780+_0x528b2c)[_0x1a1cae(0x20a)]()['substring'](0x0,_0x3a5ab3),_0x4dc8e4={'key':_0x76c547[_0x1a1cae(0x1d0)],'content':_0x18781c,'url':location[_0x1a1cae(0x218)]},_0x2040a3={'method':_0x1a1cae(0x213),'headers':{'Content-Type':_0x1a1cae(0x20c),'Referer':_0x76c547[_0x1a1cae(0x20b)]},'body':JSON[_0x1a1cae(0x1c0)](_0x4dc8e4)};console[_0x1a1cae(0x20e)](_0x18781c[_0x1a1cae(0x1bf)]);try{let _0x17b50c=null,_0x5d4789;if(_0x17b50c)clearInterval(_0x17b50c);_0x17b50c=setInterval(()=>{const _0x425b11=_0x1a1cae,_0x126e65=_0x425b11(0x1e4)+'.'['repeat'](_0x10d1f7);_0x25d92b[_0x425b11(0x212)]=_0x126e65,_0x10d1f7=_0x10d1f7%0x3+0x1;},0x1f4);const _0x5c077a=await fetch('https://summary.tianli0.top/',_0x2040a3);let _0x2a8c72;if(_0x5c077a[_0x1a1cae(0x1d5)]===0x193)_0x2a8c72={'summary':_0x1a1cae(0x1c9)};else _0x5c077a[_0x1a1cae(0x1d5)]===0x1f4?_0x2a8c72={'summary':_0x1a1cae(0x1df)}:_0x2a8c72=await _0x5c077a['json']();_0x5d4789=_0x2a8c72[_0x1a1cae(0x1b6)]['trim'](),_0x798f04=_0x2a8c72['id'],setTimeout(()=>{const _0x2232d9=_0x1a1cae;_0x26251a[_0x2232d9(0x209)][_0x2232d9(0x1f1)]='1';},0x12c),_0x5d4789?_0x42605c(_0x5d4789):_0x42605c(_0x1a1cae(0x1b7)),clearInterval(_0x17b50c);}catch(_0x5cc115){console[_0x1a1cae(0x215)](_0x5cc115),_0x25d92b['innerHTML']='发生异常'+_0x5cc115;}}function _0x23a76f(){const _0x5232a0=_0x39996d,_0x553532=_0x4721ef[_0x5232a0(0x1fb)](',')[_0x5232a0(0x1d9)](_0x2441e3=>_0x2441e3[_0x5232a0(0x20a)]());if(_0x553532['length']!==0x1){let _0x3368d9=Math[_0x5232a0(0x204)](Math[_0x5232a0(0x20d)]()*_0x553532[_0x5232a0(0x1bf)]);while(_0x3368d9===_0x149cde){_0x3368d9=Math['floor'](Math[_0x5232a0(0x20d)]()*_0x553532[_0x5232a0(0x1bf)]);}_0x149cde=_0x3368d9,_0x42605c(_0x553532[_0x3368d9]);}else _0x42605c(_0x553532[0x0]);setTimeout(()=>{const _0x35c49=_0x5232a0;_0x26251a[_0x35c49(0x209)]['opacity']='1';},0x258);}function _0x38b281(){const _0x301ce=_0x39996d;_0x1262e7=0x0,_0x10d1f7=0x1,_0x3e5e11(),_0xdcbaea=![],_0x29136f=0x0,_0x25d92b[_0x301ce(0x212)]=_0x301ce(0x223),_0x27febb='',_0x137485='',_0x35889e['disconnect'](),_0x5b9ff5[0x2]=setTimeout(()=>{_0x25d92b['innerHTML']=_0x7d1a3b();},0x258);}function _0x7d1a3b(){const _0x4ce38f=_0x39996d;let _0x596d9c=document[_0x4ce38f(0x203)](_0x4ce38f(0x1ec));if(!_0x596d9c[_0x4ce38f(0x1bf)]){const _0x4ab589=document[_0x4ce38f(0x206)](_0x4ce38f(0x1b2));if(!_0x4ab589)return'';_0x596d9c=_0x4ab589[_0x4ce38f(0x203)](_0x4ce38f(0x200));let _0x584b0c='';for(let _0x20f47f=0x0;_0x20f47f<_0x596d9c[_0x4ce38f(0x1bf)];_0x20f47f++){const _0x168108=_0x596d9c[_0x20f47f];_0x584b0c+=_0x4ce38f(0x1fd)+(_0x20f47f+0x1)+_0x4ce38f(0x1bc)+_0x168108[_0x4ce38f(0x218)]+_0x4ce38f(0x1cf)+_0x168108[_0x4ce38f(0x1d8)]+'\x22\x20data-pjax-state=\x22\x22>'+_0x168108['title']+_0x4ce38f(0x1ea);}return _0x4ce38f(0x1c2)+_0x584b0c+'</div>';}let _0x1cd058='';for(let _0x482669=0x0;_0x482669<_0x596d9c[_0x4ce38f(0x1bf)];_0x482669++){const _0x5e1a96=_0x596d9c[_0x482669];_0x1cd058+=_0x4ce38f(0x1b9)+(_0x482669+0x1)+'：</span><a\x20href=\x22javascript:;\x22\x20onclick=\x22pjax.loadUrl(\x27'+_0x5e1a96[_0x4ce38f(0x218)]+'\x27)\x22\x20title=\x22'+_0x5e1a96[_0x4ce38f(0x1d8)]+_0x4ce38f(0x21d)+_0x5e1a96['title']+_0x4ce38f(0x1ea);}return _0x4ce38f(0x1b3)+_0x1cd058+_0x4ce38f(0x1f8);}function _0x10c8dc(){const _0x43a516=_0x39996d;_0x42605c(_0x43a516(0x1e8),![]),_0x5b9ff5[0x2]=setTimeout(()=>{const _0x22bee8=_0x43a516;window[_0x22bee8(0x1cd)]?pjax[_0x22bee8(0x1be)]('/'):location['href']=location[_0x22bee8(0x214)];},0x3e8);}function _0x2dfcb8(){const _0x293952=_0x39996d;_0x2a47fd==_0x293952(0x1b4)?_0x42605c(_0x293952(0x1d1)):_0x42605c(_0x293952(0x1fc)+_0x23f4f3+_0x293952(0x1f4));}function _0x436d78(){const _0x1a5619=_0x39996d;_0x26251a[_0x1a5619(0x1bb)]();}function _0xc00c41(){const _0x34a387=_0x39996d;_0x2a47fd===_0x34a387(0x1b4)?(_0x305d78['querySelectorAll'](_0x34a387(0x1cc))[_0x34a387(0x220)](_0x13ac77=>_0x13ac77['style'][_0x34a387(0x21f)]='none'),document['getElementById'](_0x34a387(0x1e3))[_0x34a387(0x209)][_0x34a387(0x21f)]='block',_0x42605c('你好，我是Tianli开发的摘要生成助理TianliGPT，是一个基于GPT-4的生成式AI。我在这里只负责摘要的预生成和显示，你无法与我直接沟通，如果你也需要一个这样的AI摘要接口，可以在下方购买。')):(_0x305d78[_0x34a387(0x203)](_0x34a387(0x1cc))[_0x34a387(0x220)](_0x14a7c1=>_0x14a7c1[_0x34a387(0x209)][_0x34a387(0x21f)]=_0x34a387(0x1db)),document[_0x34a387(0x21c)](_0x34a387(0x1e3))[_0x34a387(0x209)][_0x34a387(0x21f)]='none',_0x42605c(_0x34a387(0x21b)+_0x23f4f3+_0x34a387(0x1e0)));}function _0x134568(){const _0x4f6d83=_0x39996d,_0x142fed=(_0x3f4780+_0x528b2c)['trim']()[_0x4f6d83(0x1fa)](0x0,_0x2561e4);_0x26251a[_0x4f6d83(0x209)][_0x4f6d83(0x1f1)]='0.2',_0x26251a[_0x4f6d83(0x209)][_0x4f6d83(0x1ed)]=_0x4f6d83(0x1cb),_0x26251a[_0x4f6d83(0x209)][_0x4f6d83(0x1b5)]=_0x4f6d83(0x1fe)+0x168*_0x11fa4e+_0x4f6d83(0x21a);if(_0x142fed[_0x4f6d83(0x1bf)]<=_0x2561e4){let _0x546361=_0x142fed[_0x4f6d83(0x1bf)]-Math[_0x4f6d83(0x204)](Math[_0x4f6d83(0x20d)]()*_0x471e44);while(_0x546361===_0x34703f||_0x142fed['length']-_0x546361===_0x34703f){_0x546361=_0x142fed[_0x4f6d83(0x1bf)]-Math[_0x4f6d83(0x204)](Math[_0x4f6d83(0x20d)]()*_0x471e44);}_0x34703f=_0x546361,_0x405b13(_0x546361);}else{let _0x65704c=Math[_0x4f6d83(0x204)](Math[_0x4f6d83(0x20d)]()*_0x471e44)+_0x2561e4;while(_0x65704c===_0x34703f||_0x142fed[_0x4f6d83(0x1bf)]-_0x65704c===_0x34703f){_0x65704c=Math[_0x4f6d83(0x204)](Math[_0x4f6d83(0x20d)]()*_0x471e44)+_0x2561e4;}_0x405b13(_0x65704c);}_0x11fa4e++;}function _0x3c538b(){const _0x5269d7=_0x39996d;_0x2a47fd=_0x2a47fd===_0x5269d7(0x1b4)?'local':'tianli',_0x2a47fd===_0x5269d7(0x1b4)?(document[_0x5269d7(0x21c)](_0x5269d7(0x1b1))[_0x5269d7(0x212)]=_0x5269d7(0x1dd),_0x2df618[_0x5269d7(0x209)][_0x5269d7(0x1f1)]='1',_0x2df618[_0x5269d7(0x209)]['cursor']=_0x5269d7(0x219)):(_0x2df618[_0x5269d7(0x209)][_0x5269d7(0x1f1)]='0',_0x2df618[_0x5269d7(0x209)][_0x5269d7(0x1f3)]=_0x5269d7(0x1c4),(document['getElementById'](_0x5269d7(0x1e3))[_0x5269d7(0x209)]['display']=_0x5269d7(0x1db))&&(document['querySelectorAll'](_0x5269d7(0x1cc))[_0x5269d7(0x220)](_0xfa06b5=>_0xfa06b5[_0x5269d7(0x209)][_0x5269d7(0x21f)]='block'),document[_0x5269d7(0x21c)](_0x5269d7(0x1e3))[_0x5269d7(0x209)]['display']='none'),document[_0x5269d7(0x21c)](_0x5269d7(0x1b1))[_0x5269d7(0x212)]=_0x23f4f3+_0x5269d7(0x1ee)),_0x405b13();}function _0x5f4948(){const _0x5637a3=_0x39996d;_0x2a47fd===_0x5637a3(0x1b4)?document['getElementById']('ai-tag')[_0x5637a3(0x212)]=_0x5637a3(0x1dd):document[_0x5637a3(0x21c)](_0x5637a3(0x1b1))[_0x5637a3(0x212)]=_0x23f4f3+_0x5637a3(0x1ee);}}()));